# Windows任务计划程序 - 完全静默执行配置

## 🔧 任务计划程序设置

### 创建任务步骤：

1. **打开任务计划程序**
   - 按 `Win + R`，输入 `taskschd.msc`，回车

2. **创建新任务**
   - 右侧点击"创建任务"（不是"创建基本任务"）

3. **常规设置**
   - 名称：`TimeLapse解锁自动拍照`
   - 描述：`Windows解锁时自动拍照并对齐`
   - ✅ 勾选"使用最高权限运行"
   - ✅ 勾选"隐藏"（重要！确保完全静默）

4. **触发器设置**
   - 点击"新建"
   - 开始任务：**在工作站解锁时**
   - 用户：**任何用户**（或选择特定用户）
   - 点击"确定"

5. **操作设置**
   - 点击"新建"
   - 操作：**启动程序**
   - **程序或脚本：** `powershell.exe`
   - **添加参数：** `**添加参数：** `-WindowStyle Hidden -ExecutionPolicy Bypass -File "D:\DevProj\TimeLapse-Desk\run_timelapse.ps1"``
   - **起始于：** `D:\DevProj\TimeLapse-Desk`
   - 点击"确定"

6. **条件设置**（可选优化）
   - 取消勾选"只有在计算机使用交流电源时才启动此任务"
   - 其他保持默认

7. **设置选项**（可选优化）
   - 取消勾选"如果任务运行时间超过以下时间，停止任务"
   - 其他保持默认

8. **保存任务**
   - 点击"确定"保存任务

## ✅ 执行效果

### 完全静默运行：
- ❌ **无PowerShell窗口**
- ❌ **无CMD窗口**  
- ❌ **无任何弹窗**
- ❌ **无用户交互**
- ✅ **后台自动执行**
- ✅ **自动拍照对齐**
- ✅ **解锁即触发**

### 执行流程：
1. Windows解锁
2. 任务计划程序触发
3. PowerShell静默启动
4. 调用bat文件（隐藏窗口）
5. 自动拍照和对齐
6. 静默完成并退出

## 🔍 查找和管理任务

### 查找创建的任务：
1. 打开任务计划程序
2. 展开左侧"任务计划程序库"
3. 找到"TimeLapse解锁自动拍照"任务

### 测试任务：
- 右键任务 → "运行"
- 检查photos文件夹是否有新照片

### 查看任务历史：
- 选中任务 → 底部"历史记录"选项卡
- 查看执行状态和时间

### 启用/禁用任务：
- 右键任务 → "启用"或"禁用"

## 🛠️ 故障排除

### 如果任务不执行：
1. 检查任务是否已启用
2. 检查触发器设置是否正确
3. 检查文件路径是否正确
4. 查看任务历史记录中的错误信息

### 如果执行出错：
1. 手动运行任务测试
2. 检查PowerShell执行策略
3. 确保conda环境可用
4. 检查摄像头是否可用

## 📝 注意事项

- 确保所有文件路径使用绝对路径
- 任务会在任何用户解锁时执行
- 静默执行意味着无法看到执行过程
- 可通过查看照片文件夹确认执行结果